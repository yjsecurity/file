<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>파일 관리자 대시보드</title>
    <style>
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th a { text-decoration: none; color: #333; }
        .upload-form { margin-bottom: 20px; padding: 15px; border: 1px solid #eee; }
    </style>
</head>
<body>
    <h1>클라우드 파일 관리자</h1>

    <div class="upload-form">
        <h2>파일 업로드</h2>
        <form action="/upload" method="POST" enctype="multipart/form-data">
            <input type="file" name="file" required>
            <button type="submit">업로드</button>
        </form>
    </div>

    <h2>파일 목록 (총 <%= files.length %>개)</h2>
    <table>
        <thead>
            <tr>
                <th>
                    <a href="/files?sort=file_name&order=<%= currentSort === 'file_name' && currentOrder === 'ASC' ? 'DESC' : 'ASC' %>">
                        파일 이름
                        <% if (currentSort === 'file_name') { %>
                            <%= currentOrder === 'ASC' ? '▲' : '▼' %>
                        <% } %>
                    </a>
                </th>
                <th>확장자</th>
                <th>
                    <a href="/files?sort=size_bytes&order=<%= currentSort === 'size_bytes' && currentOrder === 'ASC' ? 'DESC' : 'ASC' %>">
                        크기
                        <% if (currentSort === 'size_bytes') { %>
                            <%= currentOrder === 'ASC' ? '▲' : '▼' %>
                        <% } %>
                    </a>
                </th>
                <th>
                    <a href="/files?sort=uploaded_at&order=<%= currentSort === 'uploaded_at' && currentOrder === 'DESC' ? 'ASC' : 'DESC' %>">
                        업로드 날짜
                        <% if (currentSort === 'uploaded_at') { %>
                            <%= currentOrder === 'DESC' ? '▼' : '▲' %>
                        <% } %>
                    </a>
                </th>
                <th>다운로드</th>
            </tr>
        </thead>
        <tbody>
            <% files.forEach(file => { %>
                <tr>
                    <td><%= file.file_name %></td>
                    <td><%= file.extension %></td>
                    <td><%= (file.size_bytes / (1024 * 1024)).toFixed(2) %> MB</td>
                    <td><%= file.uploaded_at.toLocaleString() %></td>
                    <td><a href="<%= file.blob_url %>" target="_blank">다운로드</a></td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</body>
</html>
