<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íŒŒì¼ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        h1 { margin: 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th a { text-decoration: none; color: #333; }
        .upload-form { margin-bottom: 20px; padding: 15px; border: 1px solid #eee; background-color: #f9f9f9; }
        .action-button { background: none; border: none; color: #007bff; cursor: pointer; text-decoration: underline; padding: 0; font-size: 1em; }
    </style>
</head>
<body>
    <header>
        <h1>í´ë¼ìš°ë“œ íŒŒì¼ ê´€ë¦¬ì</h1>
        <a href="/logout">ğŸšª ë¡œê·¸ì•„ì›ƒ</a> </header>

    <div class="upload-form">
        <h2>íŒŒì¼ ì—…ë¡œë“œ (ë‹¨ì¼)</h2>
        <form action="/upload" method="POST" enctype="multipart/form-data">
            <input type="file" name="file" required>
            <button type="submit">ì—…ë¡œë“œ</button>
        </form>
    </div>

    <h2>íŒŒì¼ ëª©ë¡ (ì´ <%= files.length %>ê°œ)</h2>
    <table>
        <thead>
            <tr>
                <th>
                    <a href="/files?sort=file_name&order=<%= currentSort === 'file_name' && currentOrder === 'ASC' ? 'DESC' : 'ASC' %>">
                        íŒŒì¼ ì´ë¦„
                        <% if (currentSort === 'file_name') { %><%= currentOrder === 'ASC' ? 'â–²' : 'â–¼' %><% } %>
                    </a>
                </th>
                <th>í™•ì¥ì</th>
                <th>
                    <a href="/files?sort=size_bytes&order=<%= currentSort === 'size_bytes' && currentOrder === 'ASC' ? 'DESC' : 'ASC' %>">
                        í¬ê¸°
                        <% if (currentSort === 'size_bytes') { %><%= currentOrder === 'size_bytes' ? 'â–²' : 'â–¼' %><% } %>
                    </a>
                </th>
                <th>
                    <a href="/files?sort=uploaded_at&order=<%= currentSort === 'uploaded_at' && currentOrder === 'DESC' ? 'ASC' : 'DESC' %>">
                        ì—…ë¡œë“œ ë‚ ì§œ
                        <% if (currentSort === 'uploaded_at') { %><%= currentOrder === 'DESC' ? 'â–¼' : 'â–²' %><% } %>
                    </a>
                </th>
                <th>ì•¡ì…˜</th> </tr>
        </thead>
        <tbody>
            <% files.forEach(file => { %>
                <tr>
                    <td><%= file.file_name %></td>
                    <td><%= file.extension %></td>
                    <td><%= (file.size_bytes / (1024 * 1024)).toFixed(2) %> MB</td>
                    <td><%= file.uploaded_at.toLocaleString() %></td>
                    <td>
                        <a href="<%= file.blob_url %>" target="_blank" download="<%= file.file_name %>">ë‹¤ìš´ë¡œë“œ</a>
                        |
                        <form action="/delete/<%= file.id %>" method="POST" style="display: inline;" onsubmit="return confirm('ì •ë§ë¡œ <%= file.file_name %> íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                            <button type="submit" class="action-button">ì‚­ì œ</button>
                        </form>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</body>
</html>
